---
import '../assets/styles/index.css';
import { createReader } from '@keystatic/core/reader';
import keystaticConfig from '../../keystatic.config';
import type { Post } from '~/types';

export const prerender = true;

const reader = createReader(process.cwd(), keystaticConfig);

// Fetch sponsors
const sponsorsEntries = await reader.collections.sponsors.all();
const sponsors = sponsorsEntries
  .sort((a, b) => (a.entry.displayOrder || 0) - (b.entry.displayOrder || 0))
  .map((sponsor) => ({
    src: sponsor.entry.logo || '',
    alt: sponsor.entry.name,
    width: 120,
    height: 48,
  }))
  .filter((sponsor) => sponsor.src); // Filter out sponsors without logos

// Fetch recent events (latest 3)
const eventsEntries = await reader.collections.events.all();
const recentEvents: Post[] = eventsEntries
  .sort((a, b) => new Date(b.entry.eventDate).getTime() - new Date(a.entry.eventDate).getTime())
  .slice(0, 3)
  .map((event) => ({
    id: event.slug,
    slug: event.slug,
    permalink: `/events/${event.slug}`,
    publishDate: new Date(event.entry.eventDate),
    updateDate: new Date(event.entry.eventDate),
    title: event.entry.title,
    excerpt: event.entry.excerpt || '',
    image: event.entry.coverImage || '',
    category: { slug: 'events', title: 'Events' },
    tags: event.entry.galleryTag ? [{ slug: event.entry.galleryTag, title: event.entry.galleryTag }] : [],
    metadata: {},
  }));

// Helper to format date as DD-MM-YYYY
const formatDate = (date: Date) => {
  return date
    .toLocaleDateString('en-GB', {
      day: '2-digit',
      month: '2-digit',
      year: 'numeric',
    })
    .replace(/\//g, '-');
};

// Helper to extract time (HH:MM)
const formatTime = (date: Date) => {
  return date.toLocaleTimeString('en-GB', {
    hour: '2-digit',
    minute: '2-digit',
    hour12: false,
  });
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSI - INNOWAVE | Technocultural Society of MAIT</title>
    <link rel="icon" type="image/x-icon" href="logoWhite.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Space+Grotesk:wght@300..700&family=Spline+Sans+Mono:ital,wght@0,300..700;1,300..700&family=Syne:wght@400..800&display=swap"
      rel="stylesheet"
    />
    <script is:inline src="/lenis.js"></script>
  </head>

  <body>
    <div class="grain"></div>
    <div id="trailer"></div>
    <canvas id="canvas"></canvas>
    <nav id="nav">
      <img class="logo" src="logo.png" alt="" />
      <div class="menu" id="menu">
        <div class="menuText">
          <span class="menuNotClicked">MENU</span>
          <span class="menuClicked">CLOSE</span>
        </div>

        <div class="menuDots">
          <div class="dot"></div>
          <div class="dot"></div>
        </div>

        <div class="menuCont">
          <div class="menuItemsCont">
            <div class="menuItem active"><span>Home</span></div>
            <div class="menuItem"><span>Team</span> <i class="bi bi-arrow-right"></i></div>
            <div class="menuItem"><span>events</span> <i class="bi bi-arrow-right"></i></div>
            <div class="menuItem"><span>gallery</span> <i class="bi bi-arrow-right"></i></div>
            <div class="menuItem"><span>about</span> <i class="bi bi-arrow-right"></i></div>
          </div>
          <div class="menuItemsCont black">
            <div class="menuItem"><span>Brochure</span> <i class="bi bi-arrow-up-right"></i></div>
          </div>
        </div>
      </div>
    </nav>
    <div class="currentActivity" id="currentActivity">
      <div class="eventName">
        <div class="greenPulse"></div>
        <span>uncharted'25</span>
      </div>
      <div class="joinBtn center">Join Us</div>
    </div>
    <main class="center">
      <div class="sectionName mainSection">
        <div class="sectionNum">[001] introduction</div>
        <div class="sectionNameText">MAIT TECHNO-CULTURAL SOCIETY</div>
      </div>
      <div class="brandName">
        <div class="brandone"><span>CSI</span></div>
        <div class="brandtwo"><span>INNOWAVE</span></div>
      </div>
      <div class="brandTaglines">
        <div class="tagline-1">
          <span
            >WHERE INNOVATON MEETS <br />
            EXCELLENCE.</span
          >
        </div>
        <div class="tagline-2">
          <span>We are a technocultural community bridging creativity and real-world innovation.</span>
        </div>
      </div>
    </main>
    <section class="trust">
      <div class="trustHeading">Trusted by Teams Across Industries</div>

      <div class="trustyCont">
        {
          sponsors.length > 0 ? (
            sponsors.map((sponsor) => (
              <div class="company">
                <img src={sponsor.src} alt={sponsor.alt} width={sponsor.width} height={sponsor.height} />
              </div>
            ))
          ) : (
            <div class="no-sponsors">no sponsors for now</div>
          )
        }
      </div>
    </section>
    <section class="updates">
      <div class="sectionName">
        <div class="sectionNum">[002] activity</div>
        <div class="sectionNameText">Updates & Events</div>
      </div>
      <div class="updateBoxCont">
        {
          recentEvents.map((event) => (
            <div class="updateBox">
              <img src={event.image} alt={event.title} />
              <div class="updateInfo">
                <h3 class="updateHeading">{event.title}</h3>
                <p class="updateDesc">{event.excerpt}</p>
                <div class="updateTags">
                  <div class="tag">
                    <i class="bi bi-calendar" /> {formatDate(event.publishDate)}
                  </div>
                  <div class="tag">
                    <i class="bi bi-clock" /> {formatTime(event.publishDate)}
                  </div>
                </div>
              </div>
            </div>
          ))
        }
      </div>
    </section>
    <section class="about" id="aboutSection">
      <div class="sectionName whiteSection">
        <div class="sectionNum">[003] about</div>
        <div class="sectionNameText">About us</div>
      </div>
      <div id="aboutContentContainer" class="aboutContentCont center">
        <div id="aboutContent" class="aboutContent center"></div>
        <div class="numbersCont">
          <div class="numbers">
            <div class="numberTopHr widthZero"></div>
            <span id="numbersHeading" class="fadeLeft">In the numbers</span>
            <div class="numberBottomHr widthZero"></div>
          </div>
          <div class="statCont">
            <div class="statDiv">
              <div class="statValue fadeAway">50+</div>
              <div class="statText fadeAway">members</div>
            </div>
            <div class="statDiv">
              <div class="statValue fadeAway">50+</div>
              <div class="statText fadeAway">collaborations</div>
            </div>
            <div class="statDiv">
              <div class="statValue fadeAway">14</div>
              <div class="statText fadeAway">years of csi</div>
            </div>
            <div class="statDiv">
              <div class="statValue fadeAway">1000+</div>
              <div class="statText fadeAway">participants</div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="bento">
      <div class="sectionName">
        <div class="sectionNum">[004] Highlights</div>
        <div class="sectionNameText">What we are doing</div>
      </div>
      <div class="bentoCont">
        <div id="cards">
          <div class="card">
            <div class="card-content">
              <div class="card-image">
                <img src="update-1.webp" alt="" />
              </div>
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3>Digital Revolution</h3>
                    <h4>VR gaming stall showcased our tech enthusiasm in Innovation Mela.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <div class="card-image">
                <img src="update-1.webp" alt="" />
              </div>
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3>Digital Revolution</h3>
                    <h4>VR gaming stall showcased our tech enthusiasm in Innovation Mela.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <div class="card-image">
                <img src="update-1.webp" alt="" />
              </div>
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3>Digital Revolution</h3>
                    <h4>VR gaming stall showcased our tech enthusiasm in Innovation Mela.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card longCard">
            <div class="card-content">
              <div class="card-image">
                <img src="update-1.webp" alt="" />
              </div>
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3>Digital Revolution</h3>
                    <h4>VR gaming stall showcased our tech enthusiasm in Innovation Mela.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <div class="card-image">
                <img src="update-1.webp" alt="" />
              </div>
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3>Digital Revolution</h3>
                    <h4>VR gaming stall showcased our tech enthusiasm in Innovation Mela.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-content">
              <div class="card-image">
                <img src="update-1.webp" alt="" />
              </div>
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3>Digital Revolution</h3>
                    <h4>VR gaming stall showcased our tech enthusiasm in Innovation Mela.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card longCard">
            <div class="card-content">
              <div class="card-image">
                <img src="update-1.webp" alt="" />
              </div>
              <div class="card-info-wrapper">
                <div class="card-info">
                  <div class="card-info-title">
                    <h3>Digital Revolution</h3>
                    <h4>VR gaming stall showcased our tech enthusiasm in Innovation Mela.</h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <footer id="footer">
      <div class="csiFooterName">CSI</div>
      <div class="footerLinks">
        <div class="linksContainer">
          <a class="footerLink active" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]<div class="marginrt">
            </div>home</a
          >
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>team
          </a>
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>events
          </a>
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>gallery
          </a>
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>about
          </a>
        </div>
        <div class="linksContainer">
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>instagram
          </a>
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>linkedin
          </a>
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>x
          </a>
          <a class="footerLink" href=""
            >[<div class="arrow center"><i class="bi bi-arrow-right-short"></i></div>]
            <div class="marginrt"></div>youtube
          </a>
        </div>
        <div class="linksContainer long">
          <a class="footerLink" href="">Maharaja Agrasen Institute Of Technology</a>
          <a class="footerLink" href="">csiinnowave@gmail.com</a>
          <a class="footerLink" href="">+91 8920125672</a>
        </div>
      </div>
      <div class="copyright">COPYRIGHT Â© 2025 CSI-INNOWAVE</div>
    </footer>
    <script type="module" src="/assets/js/index.js"></script>
  </body>
</html>
